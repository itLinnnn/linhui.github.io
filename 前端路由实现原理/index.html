<!DOCTYPE html><html><head><meta charset="utf-8"><title>前端路由实现原理 | 林晖的个人博客</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="MinHow,MinHow's Blog"><meta name="description" content="前端路由实现（history）了解： HTML5 history新增了两个API:history.pushState和history.replaceState  两个api都接受三个参数 状态对象（state object）：一个JavaScript对象，与用pushState()方法创建的新历史记录条目关联。无论何时用户导航到新创建的状态，popstate事件都会被触发，并且事件对象的state"><meta property="og:type" content="article"><meta property="og:title" content="前端路由实现原理"><meta property="og:url" content="https://itlinnnn.github.io/linhui.github.io/前端路由实现原理/index.html"><meta property="og:site_name" content="林晖的个人博客"><meta property="og:description" content="前端路由实现（history）了解： HTML5 history新增了两个API:history.pushState和history.replaceState  两个api都接受三个参数 状态对象（state object）：一个JavaScript对象，与用pushState()方法创建的新历史记录条目关联。无论何时用户导航到新创建的状态，popstate事件都会被触发，并且事件对象的state"><meta property="og:locale" content="default"><meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/7/7/164751eaa48e1ec6?w=2794&h=1062&f=jpeg&s=169353"><meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/7/7/164754924b198bae?w=600&h=185&f=gif&s=3409188"><meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/7/7/1647564fa8089469?w=600&h=182&f=gif&s=5217399"><meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/7/7/164756c7b5ff3cfd?w=599&h=195&f=gif&s=4251137"><meta property="og:updated_time" content="2018-07-21T03:05:00.015Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="前端路由实现原理"><meta name="twitter:description" content="前端路由实现（history）了解： HTML5 history新增了两个API:history.pushState和history.replaceState  两个api都接受三个参数 状态对象（state object）：一个JavaScript对象，与用pushState()方法创建的新历史记录条目关联。无论何时用户导航到新创建的状态，popstate事件都会被触发，并且事件对象的state"><meta name="twitter:image" content="https://user-gold-cdn.xitu.io/2018/7/7/164751eaa48e1ec6?w=2794&h=1062&f=jpeg&s=169353"><link rel="icon" href="/favicon.ico"><link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/linhui.github.io/css/style.css"><script src="/linhui.github.io/js/pace.min.js"></script></head><body><div id="container"><header id="header"><div id="banner"></div><div id="header-outer"><div id="header-menu" class="header-menu-pos animated"><div class="header-menu-container"><a href="/linhui.github.io/" class="left"><span class="site-title">林晖的博客</span></a><nav id="header-menu-nav" class="right"><a href="/linhui.github.io/"><i class="fa fa-home"></i> <span>主页</span> </a><a href="/linhui.github.io/archives"><i class="fa fa-archive"></i> <span>目录</span></a></nav><a class="mobile-header-menu-button"><i class="fa fa-bars"></i></a></div></div><div id="header-row"><div id="logo"><a href="/linhui.github.io/"><img src="/linhui.github.io/images/logo.png" alt="logo"></a></div><div class="header-info"><div id="header-title"><h2>林晖的博客</h2></div><div id="header-description"><h3>一只前端小炮儿的技术博客</h3></div></div></div></div></header><div class="outer"><section id="main" class="body-wrap"><article id="post-前端路由实现原理" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 class="post-title" itemprop="name">前端路由实现原理</h1><div class="post-title-bar"><ul><li><i class="fa fa-calendar"></i> 2018-07-21</li><li><i class="fa fa-eye"></i> <span id="busuanzi_value_page_pv"></span></li></ul></div></header><div class="article-entry post-content" itemprop="articleBody"><h2 id="前端路由实现（history）"><a href="#前端路由实现（history）" class="headerlink" title="前端路由实现（history）"></a>前端路由实现（history）</h2><h3 id="了解："><a href="#了解：" class="headerlink" title="了解："></a>了解：</h3><blockquote><p>HTML5 history新增了两个API:history.pushState和history.replaceState</p></blockquote><h4 id="两个api都接受三个参数"><a href="#两个api都接受三个参数" class="headerlink" title="两个api都接受三个参数"></a>两个api都接受三个参数</h4><ul><li><p>状态对象（state object）：一个JavaScript对象，与用pushState()方法创建的新历史记录条目关联。无论何时用户导航到新创建的状态，popstate事件都会被触发，并且事件对象的state属性都包含历史记录条目的状态对象的拷贝。</p></li><li><p>标题（title）：FireFox浏览器目前会忽略该参数，虽然以后可能会用上。考虑到未来可能会对该方法进行修改，传一个空字符串会比较安全。或者，你也可以传入一个简短的标题，标明将要进入的状态。</p></li><li><p>地址（URL）： 新的历史记录条目的地址。浏览器不会在调用pushState()方法后加载该地址，但之后，可能会试图加载，例如用户重启浏览器。新的URL不一定是绝对路径；如果是相对路径，它将以当前URL为基准；传入的URL与当前URL应该是同源的，否则，pushState()会抛出异常。该参数是可选的；不指定的话则为文档当前URL。</p></li></ul><blockquote><p>相同之处是两个API都会操作浏览器的历史记录，而不会引起页面的刷新。不同之处在于pushState会增加一条新的历史记录，而replaceState则会替换当前的历史记录</p></blockquote><h4 id="大家可以先在控制台试试，看看地址栏发生了什么变化"><a href="#大家可以先在控制台试试，看看地址栏发生了什么变化" class="headerlink" title="大家可以先在控制台试试，看看地址栏发生了什么变化"></a>大家可以先在控制台试试，看看地址栏发生了什么变化</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.history.pushState(<span class="literal">null</span>, <span class="literal">null</span>, <span class="string">"test"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.history.pushState(<span class="literal">null</span>, <span class="literal">null</span>, <span class="string">"/test"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.history.pushState(<span class="literal">null</span>, <span class="literal">null</span>, <span class="string">"#/hello"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.history.pushState(<span class="literal">null</span>, <span class="literal">null</span>, <span class="string">"?name="</span>);</span><br><span class="line">&lt;<span class="regexp">/code&gt;&lt;/</span>pre&gt;</span><br></pre></td></tr></table></figure><h3 id="实例演示"><a href="#实例演示" class="headerlink" title="实例演示"></a>实例演示</h3><blockquote><p>建立html文件，index.html<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">    &lt;title&gt;前端路由实现&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;style&gt;</span></span><br><span class="line"><span class="regexp">        .warp&#123;</span></span><br><span class="line"><span class="regexp">            width:400px;</span></span><br><span class="line"><span class="regexp">            height:400px;</span></span><br><span class="line"><span class="regexp">            border:1px solid grey;</span></span><br><span class="line"><span class="regexp">            margin:0 auto;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">        .nav&#123;</span></span><br><span class="line"><span class="regexp">            border-bottom:1px solid grey;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">        .nav li&#123;</span></span><br><span class="line"><span class="regexp">            display:inline-block;</span></span><br><span class="line"><span class="regexp">            list-style:none;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">        .nav li a&#123;</span></span><br><span class="line"><span class="regexp">            display:inline-block;</span></span><br><span class="line"><span class="regexp">            text-decoration: none;</span></span><br><span class="line"><span class="regexp">            padding:10px 15px;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">        .router&#123;</span></span><br><span class="line"><span class="regexp">            padding:20px;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">        a&#123;</span></span><br><span class="line"><span class="regexp">            cursor: pointer;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>style&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/head&gt;</span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">    &lt;section class="warp"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;div class="nav"&gt;          </span></span><br><span class="line"><span class="regexp">            &lt;ul&gt;</span></span><br><span class="line"><span class="regexp">                &lt;li&gt;&lt;a href="javascript:void(0)" data-path="index"&gt;首页&lt;/</span>a&gt;&lt;/li&gt; </span><br><span class="line">                &lt;li&gt;&lt;a href="javascript:void(0)" data-path="news"&gt;新闻&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">                &lt;li&gt;&lt;a href="javascript:void(0)" data-path="about"&gt;关于&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">            &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">        &lt;div id=<span class="string">"router"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"router"</span>&gt;</span><br><span class="line">            &lt;!-- 内容加载区域 --&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>section&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script src=<span class="string">"https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="string">"./router.js"</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/body&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>html&gt;</span><br></pre></td></tr></table></figure><p></p></blockquote><p>此时的页面为：</p><p><img src="https://user-gold-cdn.xitu.io/2018/7/7/164751eaa48e1ec6?w=2794&amp;h=1062&amp;f=jpeg&amp;s=169353" alt=""></p><blockquote><p>引入js文件router.js<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;   </span><br><span class="line">  history.replaceState(<span class="literal">null</span>,<span class="literal">null</span>,<span class="string">''</span>);<span class="comment">//最开始的状态，采用replace直接替换</span></span><br><span class="line">  $(<span class="string">'#router'</span>).html(<span class="string">'&lt;p&gt;显示内容区域&lt;/p&gt;'</span>)</span><br><span class="line">  $(<span class="string">'a'</span>).on(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.text)</span><br><span class="line">      <span class="keyword">var</span> text = <span class="keyword">this</span>.text;</span><br><span class="line">      $(<span class="string">'#router'</span>).html(<span class="string">'&lt;p&gt;'</span>+ text +<span class="string">'&lt;/p&gt;'</span>)</span><br><span class="line">      history.pushState(<span class="literal">null</span>,<span class="literal">null</span>,<span class="string">'#/'</span>+text);</span><br><span class="line">  &#125;)    </span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><p></p></blockquote><p>此时点击导航按钮时</p><p><img src="https://user-gold-cdn.xitu.io/2018/7/7/164754924b198bae?w=600&amp;h=185&amp;f=gif&amp;s=3409188" alt=""></p><ul><li>此时当点击不同的导航项的时候，地址栏上的路由进行了对应的改变，展现的内容区域也发生了变化。但是实际上这个并没有实现路由的真正含义。因为内容部分的改变是根据事件的触发而获得当前的内容。</li><li><p>此时如果点击浏览的前进和后退按钮，内容是无法监听到地址栏的变化而作出改变的</p><h4 id="在此基础上变动一下实现方式，将router-js改为："><a href="#在此基础上变动一下实现方式，将router-js改为：" class="headerlink" title="在此基础上变动一下实现方式，将router.js改为："></a>在此基础上变动一下实现方式，将router.js改为：</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 状态版</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;   </span><br><span class="line">    <span class="keyword">var</span> count = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">    $(<span class="string">'#router'</span>).html(<span class="string">'&lt;p&gt;首页&lt;/p&gt;'</span>+count[<span class="number">0</span>]+<span class="string">'&lt;p&gt;新闻&lt;/p&gt;'</span>+count[<span class="number">1</span>]+<span class="string">'&lt;p&gt;关于&lt;/p&gt;'</span>+count[<span class="number">2</span>])</span><br><span class="line">    <span class="comment">// history.replaceState(count,null,'');//最开始的状态，采用replace直接替换</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i&lt;$(<span class="string">'a'</span>).length; i++)&#123;</span><br><span class="line">        $(<span class="string">'a'</span>)[i].index = i</span><br><span class="line">        $(<span class="string">'a'</span>).eq(i).on(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.index);</span><br><span class="line">            <span class="keyword">var</span> index = <span class="keyword">this</span>.index;</span><br><span class="line">            count[index]++;</span><br><span class="line">            $(<span class="string">'#router'</span>).html(<span class="string">'&lt;p&gt;首页&lt;/p&gt;'</span>+count[<span class="number">0</span>]+<span class="string">'&lt;p&gt;新闻&lt;/p&gt;'</span>+count[<span class="number">1</span>]+<span class="string">'&lt;p&gt;关于&lt;/p&gt;'</span>+count[<span class="number">2</span>])</span><br><span class="line">            <span class="built_in">console</span>.log(count)</span><br><span class="line">            history.pushState(count,<span class="literal">null</span>,<span class="string">'#/count'</span>+count[index]);<span class="comment">//之后的状态，需要进行保存</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//监听history其他api导致地址栏url改变事件</span></span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'popstate'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e.state);</span><br><span class="line">        <span class="keyword">var</span> state = e.state;</span><br><span class="line">        $(<span class="string">'#router'</span>).html(<span class="string">'&lt;p&gt;首页&lt;/p&gt;'</span>+state[<span class="number">0</span>]+<span class="string">'&lt;p&gt;新闻&lt;/p&gt;'</span>+state[<span class="number">1</span>]+<span class="string">'&lt;p&gt;关于&lt;/p&gt;'</span>+state[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>此时的思路是做一个状态记录，记录下每个导航按钮被点击的次数。当每次执行点击导航栏切换的时候，通过history.pushState（count， null, ‘#/count’+count[index]）这个api,传递了状态对象在内，并在第三个参数中将当前已点击数作为地址栏的显示数据。示例如下：</p></blockquote><p><img src="https://user-gold-cdn.xitu.io/2018/7/7/1647564fa8089469?w=600&amp;h=182&amp;f=gif&amp;s=5217399" alt=""></p><ul><li>!!当活动历史记录条目更改时，将触发popstate事件。如果被激活的历史记录条目是通过对history.pushState（）的调用创建的，或者受到对history.replaceState（）的调用的影响，popstate事件的state属性包含历史条目的状态对象的副本。</li><li>需要注意的是调用history.pushState()或history.replaceState()不会触发popstate事件。只有在做出浏览器动作时，才会触发该事件，如用户点击浏览器的回退按钮（或者在Javascript代码中调用history.back()）</li></ul><h4 id="此处通过记录下每次的点击次数来解释了pushState的用法以及参数，其实简单的写法可以表达为："><a href="#此处通过记录下每次的点击次数来解释了pushState的用法以及参数，其实简单的写法可以表达为：" class="headerlink" title="此处通过记录下每次的点击次数来解释了pushState的用法以及参数，其实简单的写法可以表达为："></a>此处通过记录下每次的点击次数来解释了pushState的用法以及参数，其实简单的写法可以表达为：</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;   </span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> url = <span class="string">'内容展示'</span>;</span><br><span class="line"></span><br><span class="line">    history.replaceState(url,<span class="literal">null</span>,<span class="string">''</span>);<span class="comment">//最开始的状态，采用replace直接替换</span></span><br><span class="line">    $(<span class="string">'#router'</span>).html(<span class="string">'&lt;p&gt;'</span>+url+<span class="string">'&lt;/p&gt;'</span>)</span><br><span class="line"></span><br><span class="line">    $(<span class="string">'a'</span>).on(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.text)</span><br><span class="line">        url = <span class="keyword">this</span>.text;</span><br><span class="line"></span><br><span class="line">        $(<span class="string">'#router'</span>).html(<span class="string">'&lt;p&gt;'</span>+ url +<span class="string">'&lt;/p&gt;'</span>)</span><br><span class="line">        history.pushState(url,<span class="literal">null</span>,<span class="string">'#/'</span>+url);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'popstate'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e.state);</span><br><span class="line">        url = e.state</span><br><span class="line">        $(<span class="string">'#router'</span>).html(<span class="string">'&lt;p&gt;'</span>+ url +<span class="string">'&lt;/p&gt;'</span>)</span><br><span class="line"></span><br><span class="line">     &#125;);     </span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><p><img src="https://user-gold-cdn.xitu.io/2018/7/7/164756c7b5ff3cfd?w=599&amp;h=195&amp;f=gif&amp;s=4251137" alt=""></p><h5 id="现在的效果看上去其实我们相当于回到了远点，但是解决了无法监听地址栏的地址变化问题，是通过监听popstate来作出响应的。"><a href="#现在的效果看上去其实我们相当于回到了远点，但是解决了无法监听地址栏的地址变化问题，是通过监听popstate来作出响应的。" class="headerlink" title="现在的效果看上去其实我们相当于回到了远点，但是解决了无法监听地址栏的地址变化问题，是通过监听popstate来作出响应的。"></a>现在的效果看上去其实我们相当于回到了远点，但是解决了无法监听地址栏的地址变化问题，是通过监听popstate来作出响应的。</h5><h4 id="现在还只是看了这一部分的路由实现机制，要通过监听作出不同的响应。还需要更深入的与hash进行对比。"><a href="#现在还只是看了这一部分的路由实现机制，要通过监听作出不同的响应。还需要更深入的与hash进行对比。" class="headerlink" title="现在还只是看了这一部分的路由实现机制，要通过监听作出不同的响应。还需要更深入的与hash进行对比。"></a>现在还只是看了这一部分的路由实现机制，要通过监听作出不同的响应。还需要更深入的与hash进行对比。</h4><div class="post-copyright"><div class="content"><p>最后更新： 2018年07月21日 11:05</p><p>原始链接： <a class="post-url" href="/linhui.github.io/前端路由实现原理/" title="前端路由实现原理">https://itlinnnn.github.io/linhui.github.io/前端路由实现原理/</a></p><footer><a href="https://itlinnnn.github.io/linhui.github.io"><img src="/linhui.github.io/images/logo.png" alt="林晖"> 林晖</a></footer></div></div><div id="reward" class="post-modal reward-lay"><a class="close" href="javascript:;" id="reward-close">×</a> <span class="reward-title"><i class="icon icon-quote-left"></i> 请我吃糖~ <i class="icon icon-quote-right"></i></span><div class="reward-content"><div class="reward-code"><img id="rewardCode" src="/linhui.github.io/images/wechat_code.jpg" alt="打赏二维码"></div><div class="reward-select"><label class="reward-select-item checked" data-id="wechat" data-wechat="/linhui.github.io/images/wechat_code.jpg"><img class="reward-select-item-wechat" src="/linhui.github.io/images/wechat.png" alt="微信"></label> <label class="reward-select-item" data-id="alipay" data-alipay="/linhui.github.io/images/alipay_code.jpg"><img class="reward-select-item-alipay" src="/linhui.github.io/images/alipay.png" alt="支付宝"></label></div></div></div></div><footer class="article-footer"><div class="post-share"><a href="javascript:;" id="share-sub" class="post-share-fab"><i class="fa fa-share-alt"></i></a><div class="post-share-list" id="share-list"><ul class="share-icons"><li><a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://itlinnnn.github.io/linhui.github.io/前端路由实现原理/&title=《前端路由实现原理》 — 林晖的个人博客&pic=https://itlinnnn.github.io/linhui.github.ioimages/logo.png" data-title="微博"><i class="fa fa-weibo"></i></a></li><li><a class="weixin share-sns" id="wxFab" href="javascript:;" data-title="微信"><i class="fa fa-weixin"></i></a></li><li><a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://itlinnnn.github.io/linhui.github.io/前端路由实现原理/&title=《前端路由实现原理》 — 林晖的个人博客&source=" data-title="QQ"><i class="fa fa-qq"></i></a></li></ul></div></div><div class="post-modal wx-share" id="wxShare"><a class="close" href="javascript:;" id="wxShare-close">×</a><p>扫一扫，分享到微信</p><img src="//api.qrserver.com/v1/create-qr-code/?data=https://itlinnnn.github.io/linhui.github.io/前端路由实现原理/" alt="微信分享二维码"></div><div class="mask"></div><ul class="article-footer-menu"></ul></footer></div></article><aside class="post-toc-pos post-toc-top" id="post-toc"><nav class="post-toc-wrap"><ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#前端路由实现（history）"><span class="post-toc-text">前端路由实现（history）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#了解："><span class="post-toc-text">了解：</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#两个api都接受三个参数"><span class="post-toc-text">两个api都接受三个参数</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#大家可以先在控制台试试，看看地址栏发生了什么变化"><span class="post-toc-text">大家可以先在控制台试试，看看地址栏发生了什么变化</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#实例演示"><span class="post-toc-text">实例演示</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#在此基础上变动一下实现方式，将router-js改为："><span class="post-toc-text">在此基础上变动一下实现方式，将router.js改为：</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#此处通过记录下每次的点击次数来解释了pushState的用法以及参数，其实简单的写法可以表达为："><span class="post-toc-text">此处通过记录下每次的点击次数来解释了pushState的用法以及参数，其实简单的写法可以表达为：</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#现在的效果看上去其实我们相当于回到了远点，但是解决了无法监听地址栏的地址变化问题，是通过监听popstate来作出响应的。"><span class="post-toc-text">现在的效果看上去其实我们相当于回到了远点，但是解决了无法监听地址栏的地址变化问题，是通过监听popstate来作出响应的。</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#现在还只是看了这一部分的路由实现机制，要通过监听作出不同的响应。还需要更深入的与hash进行对比。"><span class="post-toc-text">现在还只是看了这一部分的路由实现机制，要通过监听作出不同的响应。还需要更深入的与hash进行对比。</span></a></li></ol></li></ol></li></ol></nav></aside><nav id="article-nav"><a href="/linhui.github.io/js中this的指向/" id="article-nav-newer" class="article-nav-link-wrap"><span class="article-nav-title"><i class="fa fa-hand-o-left" aria-hidden="true"></i> js中this的指向 </span></a><a href="/linhui.github.io/Vue的渲染函数/" id="article-nav-older" class="article-nav-link-wrap"><span class="article-nav-title">Vue的渲染函数</span> <i class="fa fa-hand-o-right" aria-hidden="true"></i></a></nav></section></div><footer id="footer"><div class="outer"><div id="footer-info" class="inner"><p><span id="busuanzi_container_site_uv" style="display:none">总访客数：<span id="busuanzi_value_site_uv"></span> </span><span id="busuanzi_container_site_pv" style="display:none">总访问量：<span id="busuanzi_value_site_pv"></span></span></p></div></div></footer><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><script>var mihoConfig={root:"https://itlinnnn.github.io/linhui.github.io",animate:!0,isHome:!1,share:!0,reward:1}</script><div class="sidebar"><div id="sidebar-search" title="Search"><i class="fa fa-search"></i></div><div id="sidebar-category" title="Categories"><i class="fa fa-book"></i></div><div id="sidebar-tag" title="Tags"><i class="fa fa-tags"></i></div><div id="sidebar-top"><span class="sidebar-top-icon"><i class="fa fa-angle-up"></i></span></div></div><div class="sidebar-menu-box" id="sidebar-menu-box"><div class="sidebar-menu-box-container"><div id="sidebar-menu-box-categories"></div><div id="sidebar-menu-box-tags"></div></div><a href="javascript:;" class="sidebar-menu-box-close">&times;</a></div><div class="mobile-header-menu-nav" id="mobile-header-menu-nav"><div class="mobile-header-menu-container"><span class="title">Menus</span><ul class="mobile-header-menu-navbar"><li><a href="/linhui.github.io/"><i class="fa fa-home"></i><span>主页</span></a></li><li><a href="/linhui.github.io/archives"><i class="fa fa-archive"></i><span>目录</span></a></li></ul></div><div class="mobile-header-tag-container"><span class="title">Tags</span><div id="mobile-header-container-tags"></div></div></div><div class="search-wrap"><span class="search-close">&times;</span> <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back"><i class="icon icon-lg icon-chevron-left"></i> </a><input class="search-field" placeholder="Search..." id="keywords"> <a id="search-submit" href="javascript:;"><i class="fa fa-search"></i></a><div class="search-container" id="search-container"><ul class="search-result" id="search-result"></ul></div></div><div id="search-tpl"><li class="search-result-item"><a href="{url}" class="search-item-li"><span class="search-item-li-title" title="{title}">{title}</span></a></li></div><script src="/linhui.github.io/js/search.js"></script><script src="/linhui.github.io/js/main.js"></script><script src="//cdn.bootcss.com/particles.js/2.0.0/particles.min.js"></script><div id="particles"></div><script src="/linhui.github.io/js/particles.js"></script><link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css"><script src="//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js"></script><script src="/linhui.github.io/js/animate.js"></script><script src="/linhui.github.io/js/pop-img.js"></script><script>$(".article-entry p img").popImg()</script></div></body></html>